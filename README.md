# Predict_stock_price
代码使用说明

代码整体分为四个部分
1.倒入包，数据预处理
2.数据格式整理
3.模型构建
4.模型调优

第一部分，我们现倒入所需的包，然后传入所需数据集，对数据进行预处理。在这一步最重要的是，将断续的数据集进行整理（股票市场有休市，周末，节假日）。第二部是对数据的进行分钟级别的抽样，原数据为每三秒一个样本，我们做分钟级别预测，所以将数据的每分钟里第零秒的数据作为本分钟的值。数据与处理完毕。
第二部分，数据格式的处理，在这一部分我们创建了两个函数scaler_data() 和refor_data() ，来帮助我们做数据格式的整理。首先是scaler_scaler(),这个函数用来将不同的属性值做标准化操作，所有的值都调整映射到（0，1）区间内并返回一个新的数据集，以及一个scaler对象用于后期预测值的返回。由于lstm模型的输入格式为（n,m,l）,n个样本，每个样本包含前m个周期，每个周期都有l哥属性。通过refor_data()，可以创建模型输入所需shape的数据集。
第三部分，模型构建部分我们构建了lstm_model(),fit_model(),plt_loss(),plt_result(),四个函数。
    lstm_model()通过keras的不同layer实现了模型的构建，并且将参数设置成为可变值，方便后期的调整以及优化。
    fit_model()中我们完成了魔性的构建以及你喝的过程，并且通过callbacks关键字实现了可定制的loss函数调节，我们可以记录未来50个epochs中loss最好的函数模型值，并且返回model以及      history两个对象。
    plt_loss()，plt_result()输出loss曲线图以及RMSE的值，用于评估预测模型的好坏。
 
 第四部分，模型优化，在此部分我们采取了两周方式，grid search 以及random search。通过这两周参数的搜索方式，来寻找最优参数，即RMSE最低的变量组。
    我们通过para_set(),来生成变量组，并返回边两组。
    通过random_search（）来随机搜索或贪婪搜获，运行变量组。记录所有变量组的的模型机过，并选取RMSE最小的作为最有模型结构。
    我们通过run_lstm(）来实现模型的一行调取，方便运行。
    
 最终我们运行得到模型结果，选出最的参数序列号，通过load已保存的模型weight值文件（.h5）,赖在此调用最有模型，并实现再次预测。
 
 到此，结束，我们实现了一个完整的机遇股票历史数据和LSTM 模型构建的股票价格预测系统。
    
    
